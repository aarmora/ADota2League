
<%if params[:id] == "1688"%>
	<%=image_tag ("brushfire.jpg"), :style => "width:83%; cursor:pointer; position:absolute; z-index:1", :id => "brushfire"%>
<%end%>
<div id="container">
	<h2><%= @player.name %> <%= render :partial => "players/endorsement_icon", :locals => {:user => @player} %></h2>
	<div class="col-md-7">
		<div class="form-horizontal" role="form">
			<% if Permissions.can_edit?(@player) %>
				<div class="form-group">
			    <label class="col-sm-2 control-label">Email</label>
			    <div class="col-sm-10">
			      <%= best_in_place_if Permissions.can_edit?(@player), @player, :email, :type => :input %>
			    </div>
			  </div>
			<% end %>
			<div class="form-group">
		    <label class="col-sm-2 control-label">Desired Roles</label>
		    <div class="col-sm-10">
		      <%= best_in_place_if Permissions.can_edit?(@player), @player, :role, :type => :input %>
		    </div>
	  	</div>
	  	<div class="form-group">
		    <label class="col-sm-2 control-label">Time Zone</label>
		    <div class="col-sm-10">
		      <%= best_in_place_if Permissions.can_edit?(@player), @player, :time_zone, :type => :select, :collection => ActiveSupport::TimeZone.zones_map.map {|k, v| [k, v.to_s]} %>
		    </div>
	  	</div>
	  	<div class="form-group">
		    <label class="col-sm-2 control-label">Free Agent?</label>
		    <div class="col-sm-10">
		      <%= best_in_place_if Permissions.can_edit?(@player), @player, :freeagentflag, :type => :checkbox %>
		    </div>
	  	</div>
		  <div class="form-group">
		    <label class="col-sm-2 control-label">AD2L Caster?</label>
		    <div class="col-sm-10">
		      <%= best_in_place_if @current_user && @current_user.is_admin?, @player, :caster, :type => :checkbox %>
		    </div>
		  </div>
		  <%if Permissions.can_edit?(@player) || @player.caster%>
			  <div class="form-group">
			    <label class="col-sm-2 control-label">Twitch URL</label>
			    <div class="col-sm-10">
			      <%= best_in_place_if Permissions.can_edit?(@player), @player, :twitch, :type => :input %>
			    </div>
			  </div>
			  <div class="form-group">
			    <label class="col-sm-2 control-label">Region</label>
			    <div class="col-sm-10">
			      <%= best_in_place_if Permissions.can_edit?(@player), @player, :region, :type => :input %>
			    </div>
			  </div>
			  <div class="form-group">
			    <label class="col-sm-2 control-label">Estimated MMR?</label>
			    <div class="col-sm-10">
			    <p class="help-block">e.g. "3200", numeric only please!</p>
			      <%= best_in_place_if Permissions.can_edit?(@player), @player, :mmr, :type => :input %>
			    </div>
			  </div>
			  <div class="form-group">
			    <label class="col-sm-2 control-label">Hours played</label>
			    <div class="col-sm-10">
			      <%= best_in_place_if Permissions.can_edit?(@player), @player, :hours_played, :type => :input %>
			    </div>
			  </div>
			<% end %>
			<% if Permissions.user_is_site_admin? %>
			  <div class="form-group">
			    <label class="col-sm-2 control-label">Admin</label>
			    <div class="col-sm-10">
			      <%= best_in_place_if @current_user && @current_user.is_admin?, @player, :admin, :type => :checkbox %>
			    </div>
			  </div>
			   <h4>Permissions</h4>
			  <table class="table table-bordered" id="perm-data-table">
			    <thead>
			      <tr>
			        <th>Person</th><th>Level</th><th>Organization</th><th>Season</th><th>Division</th>
			      </tr>
			    </thead>
			    <% @player.permissions.each do |permission| %>
			    <tr>
			      <td><%= link_to permission.player.name, permission.player %></td>
			      <td>
			        <%= best_in_place permission,
			        :permission_mode,
			        :type => :select,
			        collection: [["", "None"], ["site", "site"], ["organization","organization"], ["season", "season"], ["division","division"]] %>
			      </td>
			      <td><%= best_in_place permission, :organization_id, :type => :input%></td>
			      <td><%= best_in_place permission, :season_id, :type => :input%></td>
			      <td><%= best_in_place permission, :division, :type => :input%></td>
			    </tr>
			    <% end %>
			  </table>
			  <div class="form-group">
			  	<div class="col-sm-12">
						<%= form_for Permission.new, :html => { :class => "form-horizontal", :role => "form"} do |f| %>
							<%= f.hidden_field :player_id, :value => @player.id%>
				  		<%= f.submit "Add permissions", :class => "button"%>
				  	<%end%>
				  </div>
			  </div>
			<%end%>
		</div>
	<br />
		<%= link_to "Add player on steam", "steam://friends/add/#{@player.steamid}"%>
	<br />
	<br />
		<%= link_to "View Player on Dotabuff", "http://dotabuff.com/players/#{@player.steam32id}", :target => "blank"%>
	<br />
		<h2>Teams</h2>
		<% @player.teams.each do |team| %>
			<%= link_to team.teamname, team %><%= " (Captain - view team page to manage)" if @current_user && (team.captain_id == @current_user.id) %><%= " (Inactive)" if !team.active %><br><br>
		<% end %>

		<%if @open_season%>
			<% if @current_user && @current_user.id == @player.id %>
				<h2>Create a team</h2>
				<p>
					If you are already on a team above, and wish to register for a new season. Please select the team above
					and register for the new season from your team page instead.
				</p>

				<p>
					NOTE: you will be automatically registered for the current open season.
					Please make sure that you are positive you will be able to field 5 players each week
					before submitting this
				</p>

				<%= form_for Team.new, :html => { :class => "form-horizontal", :role => "form"} do |f| %>
					<div class="form-group">
					  <%= f.label :teamname, "Team Name", :class => "col-sm-2 control-label" %>
					  <div class="col-sm-10">
					  	<%= f.text_field :teamname %>
					  </div>
				  </div>
					<div  class="form-group">
					  <%= f.label :originalmmr, "Estimated MMR?", :class => "col-sm-2 control-label" %>
					  <div class="col-sm-10">
					  	<%= f.text_field :originalmmr %>
					  	<p class="help-block">Average your 5-player's MMRs to give us an idea of who to match you up against initially. (e.g. "3200", numeric only please!)</p>
					  </div>
					</div>
					<div class="form-group">
						<label class="col-sm-2">Preferred region?</label>
						<div class="col-sm-10">
							<div class="radio">
							  <label>
							    <%= f.radio_button :region, 'EU' %>
							    EU
							  </label>
							</div>
							<div class="radio">
							  <label>
							    <%= f.radio_button :region, 'NA' %>
							    NA
							  </label>
							</div>
						</div>
				  </div>
				  <%= f.submit "Create team", :confirm => "Are you sure you will participate at the listed times? Please ensure you and your team can make it before proceeding!", :class => "button" %>
				<% end %>
			<% end %>
		<%end%>
	</div>
	<div class="col-md-5">
		<div class="form-group">
		    <label class="col-sm-2 control-label">Bio:</label>
		    <div class="col-sm-10">
		      <%= best_in_place_if Permissions.can_edit?(@player), @player, :bio, :type => :textarea%>
		    </div>
	  	</div>
		<div class="form-group">
			<div class="col-sm-12" id="comments">
				<label>Comments:</label>
			</div>
	    <div class="col-sm-12" id="player_comments_partial">
				<%= render :partial => "players/player_comments"%>
	    </div>
			<%if @current_user%>
				<div class="form-group">
				  <%= form_for PlayerComment.new, :remote => true, :url => player_comment_path, :html => { :method => :post, :class => "form-horizontal", :role => "form"}, :id => "player_comments_form" do |f| %>
				    <%=f.text_area :comment, :style => "width:100%; height:100px;", :placeholder => "Post about your experience playing with #{@player.name} here.  Keep it friendly and helpful, please."%>
				    <%= f.hidden_field :recipient_id, :value => @player.id, :id => "player_id" %>
				    <%= f.hidden_field :commenter_id, :value => @current_user.id %>
				    <%=f.submit "Comment", :class => "button", :id => "publish"%>
				  <%end%>
				</div>
			<%end%>
	  	</div>
	</div>
</div>
