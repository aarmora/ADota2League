<% if Permissions.user_is_site_admin? %>
  <h2>Player Management</h2>
  <%= link_to "Players", admin_players_path, :class => "button"%>

  <h2>Permissions</h2>
  <table class="table table-bordered" id="admin-data-table">
    <thead>
      <tr>
        <th>Person</th><th>Level</th><th>Organization</th><th>Season</th><th>Division</th><th>Remove</th>
      </tr>
    </thead>
    <% @permissions.each do |permission| %>
    <tr>
      <td>
        <%=best_in_place permission, :player_id, :type => :select, collection: @players.collect {|player| ["#{player.id}", "#{player.name}"]} %>
      </td>
      <td>
        <%= 
          best_in_place permission,
          :permission_mode,
          :type => :select,
          collection: [["", "None"], ["site", "site"], ["organization","organization"], ["season", "season"], ["division","division"]]
        %>
      </td>
      <td><%= best_in_place permission, :organization_id, :type => :input%></td>
      <td><%= best_in_place permission, :season_id, :type => :input%></td>
      <td><%= best_in_place permission, :division, :type => :input%></td>
      <td>
        <%= form_for permission, :method => "delete" do |f|%>
          <%= f.submit "Remove", :class => "btn btn-danger btn-sm fa fa-trash-o"%>
        <% end %>
      </td>
    </tr>
    <% end %>
  </table>
  <%= form_for Permission.new, :html => { :class => "form-horizontal", :role => "form"} do |f| %>
    <%= f.submit "Add permissions", :class => "btn btn-primary"%>
  <% end %>

  <h2>Team Management</h2>
  <div>
  	<h5>View / Edit Team:</h5>
    <%= form_tag("/teams/id", :method => "get", :class => "adaptive") do %>
      <%= select_tag(:id, options_for_select(@teams.map{|team| [team.teamname, team.id]})) %>
      <%= submit_tag "View Team", :class => "button" %>
    <% end %>
  </div>

  <div>
  	<h5>Assign New Captain to Exisiting Team:</h5>
  	<%= form_tag("/teams/id", :method => "put", :class => "adaptive") do %>
  		<%= select_tag(:id, options_for_select(@teams.map{|team| [team.teamname, team.id]})) %>

  		<%= collection_select(:team, :captain_id, @players.select(&:name).sort_by(&:name), :id, :name) %>
  		<%= submit_tag "Assign Captain", :class => "button" %>
  	<% end %>
  </div>

  <div>
  	<h5>Mark team active / inactive:</h5>
    <%= form_tag("/teams/id", :method => "put", :class => "adaptive") do %>
      <%= select_tag(:id, options_for_select(Team.where(:active => false).sort_by(&:teamname).map{|team| [team.teamname, team.id]})) %>
      <%= hidden_field(:team, :active, :value => true) %>
      <%= submit_tag "Make Active", :class => "button" %>
    <% end %>
    <%= form_tag("/teams/id", :method => "put", :class => "adaptive") do %>
      <% # NOTE: needs field added to filter...also above %>
      <%= select_tag(:id, options_for_select(Team.where(:active => true).sort_by(&:teamname).map{|team| [team.teamname, team.id]})) %>
      <%= hidden_field(:team, :active, :value => false) %>
      <%= submit_tag "Make Inactive", :class => "button" %>
    <% end %>
  </div>
<% end %>
<h2>Season / Schedule Management</h2>
<p>Choose a season and week to manage</p>

<% if Permissions.user_is_site_admin? %>
  <%- #Create a new season by clickign the button, then edit! %>
  <%= form_for Season.new do |f| %>
    <%= f.submit "Create new season", :class => "btn btn-primary" %>
  <% end %>
<% end %>

<% Season.all.each do |s| %>
  <%- next unless Permissions.can_view? s %>
  <h3><%= link_to s.title, manage_season_path(s) %></h3>
<% end %>

<% if Permissions.user_is_site_admin? %>
  <%= link_to "Posts", posts_path, :class => "button"%>
<% end %>


